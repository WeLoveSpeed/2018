{{ site.data.talks }}

<section class="section" id="schedule" class="schedule">
  <div class="wrapper">
    <h1 class="text-center">
      {% t Programme %}
    </h1>
    <table summary="{{ "Programme heure par heure" | t:include.locale }}" class="schedule-container">
      <caption class="sr-only">Conférences de We Love Speed 2019, le 20 septembre</caption>
      <tbody class="schedule-body">
          {%- for line in site.data.schedule[include.year] -%}
          {% case line.type %}
            {% when 'headers' %}
              <tr class="schedule-headers">
                <th scope="col" class="schedule-header schedule-hour">{{ "Heure" | t:include.locale }}</th>
                {% assign rooms = line.values %}
                {%- for room in rooms -%}
                  <th scope="col" class="schedule-header">{{ room[include.locale] }}</th>
                {%- endfor -%}
              </tr>
            {% when 'short' %}
              <tr class="schedule-short">
                <td scope="col" class="schedule-hour">{{ line.hour }}</td>
                <td scope="col" colspan="{{ rooms | size }}">{{ line.values[include.locale] }}</td>
              </tr>
            {% when 'pause' %}
              <tr class="schedule-pause">
                <td scope="col" class="schedule-hour">{{ line.hour }}</td>
                <td scope="col" colspan="{{ rooms | size }}">{{ line.values[include.locale] }}</td>
              </tr>
            {% when 'talks' %}
              <tr class="schedule-talks">
                <td scope="col" class="schedule-hour">{{ line.hour }}</td>
                {% assign rowspan = 1 %}
                {%- for value in line.values -%}
                  {%- for item in site.talks -%}
                      {% if item.slug == value %}
                          {% assign talk = item %}
                          {% assign rowspan = value.span | default: 1 %}
                      {% endif %}
                  {%- endfor -%}
                  {% capture talkUrl %}{{ page.baseurl | default:site.baseurl }}/{{ include.year }}/{{ "interventions" | t: include.locale }}#{{ talk.slug }}{% endcapture %}
                  <td scope="col" {% unless rowspan == 1 %}rowspan="{{ rowspan }}"{% endunless %}>
                    <article class="talk talk-{{ talk.locale | slice: 0, 2 }}" id="{{ talk.slug }}">
                      <header class="room{{ forloop.index }}">
                        {%- for speakerSlug in talk.speakers -%}
                          {% assign speaker = site.data.speakers[include.year][speakerSlug] %}
                          <figure class="person person-{{ forloop.index }} {{ speaker.slug }}">
                            {% cloudinary avatar {{ speaker.image | relative_url }} class="person-avatar" alt="" %}
                          </figure>
                        {%- endfor -%}
                        <div class="talk-summary">
                          <h2>{{ talk[include.locale].title }}</h2>
                          <p class="talk-authors">
                            {% unless talk.locale == include.locale %}{{ " en anglais" | t: page.locale }}{% endunless %}
                            {%- for speakerSlug in talk.speakers -%}
                              {% assign speaker = site.data.speakers[include.year][speakerSlug] %}
                              {% if forloop.first %} {%t par %} {{ speaker.name }}{% else %}{{ speaker.name }}{% endif %}
                              {%- unless forloop.last -%}, {%- endunless -%}
                            {%- endfor -%}
                          </p>
                        </div>
                      </header>
                      <section class="talk-excerpt">
                        <p>{{ talk[include.locale].description | truncatewords: 20 }}</p>
                      </section>
                      <footer>
                        <span class="schedule-room">{{ rooms[forloop.index0][include.locale] }}</span>
                        <a href="{{ talkUrl }}">{{ "Détails" | t:include.locale }}</a>
                      </footer>
                    </article>
                  </td>
                {%- endfor -%}
              </tr>
            {% else %}
          {% endcase %}
          {%- endfor -%}
      </tbody>
    </table>
  </div>
</section>
<hr class="wrapper">
