{% capture nowUnix %}{{ site.time | date: '%s'}}{% endcapture %}
<section class="section talks">
  <div class="wrapper">
    <h2 class="text-center">
      {% t Aperçu %}
    </h2>
    {% for conference in include.conferences %}
      {% capture pubDateUnix %}{{ conference.pub_date | date: '%s' }}{% endcapture %}
      {% if pubDateUnix <= nowUnix %}

      <hr id="{{ conference.slug }}">
      {% if include.locale == "en_US" and conference.en_US %}
        {% assign verbatim = conference.en_US %}
        {% assign other_verbatim = conference.fr_FR %}
      {% else %}
        {% assign verbatim = conference.fr_FR %}
        {% assign other_verbatim = conference.en_US %}
      {% endif %}
      <article class="conference">
        <h3>
          {{ verbatim.title }}&nbsp;<a href="#{{ conference.slug }}" class="text-xs">#</a>
        </h3>
        {{ verbatim.description | markdownify }}
        {% if verbatim.transcript or verbatim.slides or verbatim.video or other_verbatim.transcript or other_verbatim.slides or other_verbatim.video %}
          <p class="text-center">
          {% if verbatim.transcript %}
            <a class="button" data-text="{% t lire la version textuelle %}" href="{{ verbatim.transcript }}" title="{% t lire la version textuelle %}"><span class="button-inner">{% t lire la version textuelle %}</span></a>
          {% else %}
            {% if other_verbatim.transcript %}
              {% capture text_button %}{% t lire la version textuelle %} ({% if include.locale == "en_US" %}fr{% else %}en{% endif %}){% endcapture %}
              <a class="button" data-text="{{ text_button }}" href="{{ other_verbatim.transcript }}" title="{{ text_button }}"><span class="button-inner">{{ text_button }}</span></a>
            {% endif %}
          {% endif %}
          {% if verbatim.slides %}
            <a class="button" data-text="{% t consulter le support %}" href="{{ verbatim.slides }}" title="{% t consulter le support %}"><span class="button-inner">{% t consulter le support %}</span></a>
          {% else %}
            {% if other_verbatim.slides %}
              {% capture text_button %}{% t consulter le support %} ({% if include.locale == "en_US" %}fr{% else %}en{% endif %}){% endcapture %}
              <a class="button" data-text="{{ text_button }}" href="{{ other_verbatim.slides }}" title="{{ text_button }}"><span class="button-inner">{{ text_button }}</span></a>
            {% endif %}
          {% endif %}
          {% if verbatim.video %}
            <a class="button" data-text="{% t voir la vidéo %}" href="{{ verbatim.video }}" title="{% t voir la vidéo %}"><span class="button-inner">{% t voir la vidéo %}</span></a>
          {% else %}
            {% if other_verbatim.video %}
              {% capture text_button %}{% t voir la vidéo %} ({% if include.locale == "en_US" %}fr{% else %}en{% endif %}){% endcapture %}
              <a class="button" data-text="{{ text_button }}" href="{{ other_verbatim.video }}" title="{{ text_button }}"><span class="button-inner">{{ text_button }}</span></a>
            {% endif %}
          {% endif %}
          </p>
        {% endif %}
          {% for name in conference.speakers %}
            {% assign speaker = site.data.speakers[include.year][name] %}
            {% if include.locale == "en_US" and speaker.en_US %}
              {% assign speakatim = speaker.en_US %}
            {% else %}
              {% assign speakatim = speaker.fr_FR %}
            {% endif %}
            <section class="conference-speaker text-sm">
              <figure class="conference-speaker-pic" role="group">
                <img src="{{ speaker.image | relative_url }}" class="person-avatar" alt="" />
                <figcaption class="sr-only">{{ speaker.name }}</figcaption>
              </figure>
              <h3 class="conference-speaker-name">
                {% assign speakerCount = conference.speakers | size %}
                {% unless speakerCount > 1 %}
                  <span class="text-xs">{% t Présenté %}{% unless speaker.locale == include.locale %}{{ " en anglais" | t: page.locale }}{% endunless %} {%t par %}</span><br>
                {% else %}
                  <span class="text-xs">{% t Animé %}{% unless speaker.locale == include.locale %}{{ " en anglais" | t: page.locale }}{% endunless %} {%t par %}</span><br>
                {% endunless %}
                {% capture person %}<em>{{ speaker.name }}</em>{% endcapture %}
                {% if speaker.url %}
                  {% capture person %}<a href="{{ speaker.url }}">{{ person }}</a>{% endcapture %}
                {% endif %}
                {{ person }}
              </h3>
              <p class="conference-speaker-description">
                {{ speakatim.bio | markdownify }}
              </p>
            </section>
          {%- endfor -%}
      </article>
      {%- endif -%}
    {%- endfor -%}
  </div>
</section>

